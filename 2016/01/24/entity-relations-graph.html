<p>We are often challenged with the maintenance of existing projects that were developed by other agencies, or a new developer arrives and we need to quickly bring them on board. The complexity of legacy projects can be very high and the risk of breaking existing logic is something we want to avoid.</p>

<p>One way we like to look at a project before diving into the code is through its data structure. The different entities and their relations can tell us a lot about the business logic of the site and its internal logic. We assumed that if we could <em>easily</em> generate a graph with all the bundles, entities, and their relations this complex task would be easier.</p>

<p>Having done this for a while now, I believe our assumption was right. Taking our open-source <a href="https://github.com/Gizra/productivity#gizra-productivity">Productivity project</a> (Gizra&rsquo;s internal ERP/Project management system) as an example, it&rsquo;s much easier to look at the following graph and understand that <code>Work session</code>, <code>Time tracking</code>, <code>Payment</code>, and <code>Github Issue</code> bundles are pointing at a <code>Project</code>, which in turn points to an <code>Account</code> bundle. <code>Github Issue</code> can also reference itself.</p>

<div class="thumbnail">
  <div class="img-wrapper">

    

    
      <img src="http://www.gizra.com/assets/images/posts/entity-relations/image1.jpg">
    

  </div>
  
</div>

<!-- more -->

<p>Thanks to <a href="https://www.drupal.org/u/damien-tournoud">Damien Tournoud&rsquo;s</a> <a href="https://www.drupal.org/project/1438582/git-instructions">previous work</a> getting the graph out wasn&rsquo;t too complicated. His sanbox module already output the entities and bundles. It was merely missing the relationships between them, and a UI to display the graph.</p>

<p>So, standing on the shoulders of giants, we&rsquo;ve adapted the code and now have an <a href="https://github.com/Gizra/entitiesdiagram">Entities Diagram</a> module.</p>

<h2>Usage</h2>

<p>There are two interfaces to get the graph:</p>

<h3>Drush</h3>

<p>When using Drush we need the <a href="http://www.graphviz.org/doc/info/command.html">Graphviz</a> command line library to generate the graph,
since the module only generates text file in the <a href="https://en.wikipedia.org/wiki/DOT_(graph_description_language">DOT language</a>.</p>

<p>Use this from the command line to get an image:<br>
<code>drush entitiesdiagram | dot -Gratio=0.7 -Eminlen=2 -T png -o ./test.png</code></p>

<h3>UI</h3>

<p>Craft your URL according to your needs:</p>

<ul>
<li>All the entities at <code>/admin/entities-diagram</code></li>
<li>Only the node&rsquo;s bundles <code>/admin/entities-diagram/node</code></li>
<li>A simplified graph of the node&rsquo;s bundles, with no fields at <code>/admin/entities-diagram/node/false</code></li>
</ul>

<p>Simple, but powerful.</p>
