<!DOCTYPE html><html><head><title>Faithful Elm and the Amazing Router</title><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta property=og:site_name content=Gizra><meta property=og:title content="Faithful Elm and the Amazing Router"><meta name=description content="Building an Elm demo app to show how Elm can be used in a project."><meta property=og:description content="Building an Elm demo app to show how Elm can be used in a project."><meta name=twitter:card content="summary_large_image"/><meta name=twitter:site content="@gizra_drupal"/><meta property=og:image content=https://www.gizra.com/assets/images/posts/faithful-elm-amazing-router/thumb.jpg><link rel=apple-touch-icon sizes=180x180 href=/assets/favicons/apple-touch-icon-180x180.png><link rel=icon type=image/png href=/assets/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/assets/favicons/favicon-194x194.png sizes=194x194><link rel=icon type=image/png href=/assets/favicons/favicon-96x96.png sizes=96x96><link rel=icon type=image/png href=/assets/favicons/android-chrome-192x192.png sizes=192x192><link rel=icon type=image/png href=/assets/favicons/favicon-16x16.png sizes=16x16><link rel=manifest href=/assets/favicons/manifest.json><meta name=msapplication-TileColor content=#000000><meta name=msapplication-TileImage content=/assets/favicons/mstile-144x144.png><meta name=theme-color content=#ffffff><link href="https://fonts.googleapis.com/css?family=Abril+Fatface&text=gizra" rel=stylesheet><link href="https://fonts.googleapis.com/css?family=Esteban" rel=stylesheet><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700" rel=stylesheet><link href="https://fonts.googleapis.com/css?family=Montserrat:500,700" rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.7/semantic.min.css integrity="sha256-wT6CFc7EKRuf7uyVfi+MQNHUzojuHN2pSw0YWFt2K5E=" crossorigin="anonymous"/><link rel=stylesheet href="/assets/stylesheets/style.css"/><script src=https://code.jquery.com/jquery-2.2.4.min.js integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.7/semantic.min.js integrity="sha256-flVaeawsBV96vCHiLmXn03IRJym7+ZfcLVvUWONCas8=" crossorigin=anonymous></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-6558346-3', 'auto');
  ga('send', 'pageview');</script></head><body class=pushable><div class="ui sidebar inverted vertical menu left"><a class="item active" href="/">Home</a> <a class=item href=/team>Team</a> <a class=item href=/blog>Blog</a> <a class=item href=/podcast>Podcast</a> <a class=item href=/projects>Projects</a> <a class=item href=/our-story>Our Story</a> <a class=item href=/contact>Contact</a></div><div class=pusher><div class="ui grid container"><header class=row><div class="five wide column menu bar"><div class="ui large secondary menu"><a class="item sidebar-toggle"><i class="big sidebar icon"></i> Menu</a></div></div><div class="six wide computer six wide tablet eleven wide mobile column center aligned"><a class=gizra-logo href="/"><svg xmlns=http://www.w3.org/2000/svg width=252 height=104><title>gizra</title><path fill=#E27058 fill-rule=evenodd d="M44.3 21.6c.2 3.5 3 5.4 6 5.4 3.5 0 6.7-2 6.7-7s-3.6-7.7-8.5-7.7c-4.3 0-10.3 2.5-10.3 11 0 1.7.2 3.4.6 5.3-3.4-2-6.5-2.6-11.6-2.6-16 0-22.7 7.6-22.7 17.5 0 8.7 4 13.7 12.2 16-8.2 5-12 7.8-12 13.8C4.7 78 8 83 20.7 83h10c11 0 13.4 2 13.4 7 0 6.7-5.8 11.3-17 11.3s-13.4-4.7-13.4-9c0-1.8.2-3.5 1-5.8l-6.4-3C4.5 84.8.2 87 .2 92c0 6.8 7.5 11.3 25.8 11.3 21.2 0 29.6-8.5 29.6-20 0-14.4-12-17.2-23.8-17.2H21c-5.5 0-6.6-.4-6.6-1.4 0-1 1-2 4.6-4.4 2.2.4 5.4.8 8.5.8C40.3 61 49 55 49 43c0-6.8-4-10.5-8-13.3-.6-2.5-.8-4.6-.8-6.3 0-6.5 3-7 4.5-7 2.2 0 2.8 1.7 2.5 3.4l-3 1.8zM22 41.2C22 29.7 24 28 27 28s4.6 1.4 4.6 13.2v5c0 11-1.8 12.7-4.6 12.7-3.2 0-5-2.3-5-12V41zM62 10c0 4.4 2 9.8 10.6 9.8 7.6 0 10.6-4.3 10.6-10 0-6.3-3.8-9.6-10.4-9.6C65 .2 62 5 62 10zm-5.4 17v2h6.2v46H57v2h31.2v-2h-6V27H56.7zm82.5 0H95l-1.4 20.2H95c4.3-15 8-18.3 22.2-18.3h1L93 75.3V77h44l1.8-21.5h-1.5C133.5 69 127.5 75 115.6 75h-1.4l25-46v-2zm41 3c2.2 0 4.3 1 2.2 5.3h-3.8c-2.2 7.5 1 12 8.2 12 5.6 0 8.8-4 8.8-10 0-8-5-11.3-11.2-11.3-6.3 0-12 3.6-14 11V27H145v2h5.7v46h-5.8v2h32.6v-2h-7.4V47c0-9.5 4.7-17 9.7-17zm40.5 22.3c-15 0-24.2 2.4-24.2 13 0 10.5 8.2 12.8 15.6 12.8 7.2 0 10.3-2.7 12-7.7 1.2 5 6 7.8 14.4 7.8 9 0 13-3.5 13.5-16l-1.7-.2c-.5 8.8-2.3 10.8-4.2 10.8-1.7 0-3-1.2-3-5.5V46c0-15.2-5.5-19.8-22-19.8-14.3 0-22 4-22 13 0 5 2.6 8.6 9 8.6 5.3 0 9.3-3.3 9.3-8.2 0-2-.3-3.4-.8-4.7H214c-.6-1.2-.8-2.2-.8-3 0-3.4 3-4.3 5-4.3 4.2 0 5.3 3.5 5.3 16.8v8h-3zM219 73.8c-2 0-2.7-1-2.7-8.6v-1.6c0-6.4 2-9.6 6.5-9.6h.7v9.8c0 6.7-2.5 10-4.5 10z"/></svg></a><div class=tagline>We Build Websites</div></div><div class="five wide computer only column"></div></header><div class="ui grid centered post"><div class="sixteen wide mobile sixteen wide tablet twelve wide computer column"><div class="ui raised padded segment"><h1 class="ui dividing header"><div class="ui image"><img src=/assets/images/team/avatars/amitaibu.jpg class="ui circular image"></div><div class=content><a href="/content/faithful-elm-amazing-router/">Faithful Elm and the Amazing Router</a><div class="sub header">By Amitai Burstein (@amitaibu) // 16 Jun 2016</div></div><div class="right floated column"><a href=/blog class="ui teal right ribbon big label">Blog Post</a></div></h1><p><a href=https://youtu.be/FgaoOgJ5CAU>I gave</a> an Elm session in <a href=http://yougottalovefrontend.com/#page-speakers>YGLF conf</a>. This was a great excuse to free up some hours to work on a new v0.17 SPA (Single Page Application). You won’t believe what happened next…</p><p>Well, actually, you would: it was an awesome experience. :)<br/>In fact, I’ve reached the point that the backend me is becoming jealous of the frontend me.</p><div class="ui horizontal segments"><div class="ui center aligned secondary grey segment"><a class=demo target=_blank href="http://elm-spa-example.gizra.com/">View demo</a></div><div class="ui center aligned secondary grey segment"><a class=code target=_blank href=https://github.com/Gizra/elm-spa-example>Get the source code</a></div></div><div class="ui segments"><div class="ui attached center aligned segment"><div class="ui image"><img src="https://www.gizra.com/assets/images/posts/faithful-elm-amazing-router/image1.gif"/></div></div><div class="ui attached center aligned caption segment">Fetch GitHub user's info on this fake login.</div></div><p>My goal with building this demo app, was to give a small, yet realistic, look into how Elm allows us to accomplish daily tasks such as HTTP requests, routing, access, and more. It was important for me to structure it in the same way that we structure larger apps built for production, so that it could demonstrate more effectively how Elm can be used in a project.</p><p>If you are interested in Elm, and want to get a feeling of how it could be built for your apps, this might be a good starting point. I even wanted to add a single test to show how it could be done. But Elm being such a fun, predictable, opinionated, and fun (no mistake here, it deserves the double fun) to work with, I ended up adding more and more tests.<br/>Isn’t that yet another great sign for Elm? I was adding unit tests for a <em>demo</em> app, while we hardly added any unit tests for our Angular apps in production!</p><p>I held myself back from adding too many features, but I couldn’t resist polishing the existing ones, and adding <em>lots</em> of comments. With the compiler’s tough love and ever growing unit tests, changes were so easy it almost felt like cheating (and note that I rarely write “easy” or “trivial” about development issues).</p><p>In general, at least for me, the great thing that Elm brings to the table is the reduced cognitive load. We don’t need to remember too much about our application at every single moment. This means we can concentrate on our current component and make sure it’s being wired in correctly to the entire application.</p><p>With <a href=https://github.com/avh4/elm-format>Elm-format</a> we don’t even need to bother ourselves with the file format; and along with the Atom integration on every save, we get consistent looking files.</p><h2 id=wiring-multiple-components>Wiring Multiple Components</h2><p>One of the questions I see people struggle with is how should the different components communicate with each other. I won’t get into depth here, but rather give some pointers to the code base. The gist of things:</p><ol><li>Main module is mostly boilerplate, and it cares only about the App module.</li><li>The App module is conveniently <a href=https://github.com/Gizra/elm-spa-example/tree/1.0.0/src/elm/App>split</a> into Model, Update, and View files. This is the heart of our web app, and it is responsible for calling and delegating the work to the right modules (a.k.a components) via its <code class=highlighter-rouge>update</code> function.</li><li>Same for the <a href=https://github.com/Gizra/elm-spa-example/blob/1.0.0/src/elm/App/View.elm#L103-L117>view</a>: it’s calling the child modules.</li><li>Any module, like the <code class=highlighter-rouge>App</code> for example, is always communicating <a href=https://github.com/Gizra/elm-spa-example/blob/1.0.0/src/elm/App/Update.elm#L26>downwards</a> to its child modules. It needs to know about the child module, but the child doesn’t need to know about it. Nor does the parent module need to know about the grandchildren, if they exist.</li><li>Child modules can pass information back to the parent module. Really! It’s done in the update function by simply returning more info. While the typical signature of an <code class=highlighter-rouge>update</code> function is <code class=highlighter-rouge>(Model, Cmd Msg)</code> nothing stops the <a href=https://github.com/Gizra/elm-spa-example/blob/1.0.0/src/elm/Pages/Login/Update.elm#L25>child’s update</a> function from being <code class=highlighter-rouge>(Model, Cmd Msg, Int)</code>, where <code class=highlighter-rouge>Int</code> will be some numeric value the <a href=https://github.com/Gizra/elm-spa-example/blob/1.0.0/src/elm/App/Update.elm#L28-L29>parent</a> can act on.</li></ol><h2 id=elm-route-url>Elm Route Url</h2><p>With the new official <a href=https://github.com/elm-lang/navigation>Navigation</a> module in place, the need for SPA routers has been met. However, Navigation isn’t just a router module, it’s providing the building blocks for <em>other</em> routing solutions. It merely has a certain solution as a “serving suggestion”.</p><p>@rgrempel’s <a href=https://github.com/rgrempel/elm-route-hash>elm-route-url</a> module indeed builds on the foundations of Navigation, however it takes a different approach, which I personally prefer. As you may have read in one of my previous posts under the <a href="/content/thinking-choosing-elm/">Url change is not routing</a> paragraph, elm-route-url allows us to add routing (i.e. actually changing the URL) <em>after</em> the fact, with very little change to the existing code base. For example, when I wrote the demo app, I started step by step, wiring different components into my app.</p><p>The App.Model has a property called <a href=https://github.com/Gizra/elm-spa-example/blob/1.0.0/src/elm/App/Model.elm#L9-L17>activePage</a> which is, as the name implies, responsible for knowing which page is active. In fact, I have written the entire app without having a URL change. Just to emphasize, there were “page” changes, they were simply not reflected in the URL.</p><p>So once I wanted to wire-in the Navigation, I realized I needed to change my existing app. For example, in my <code class=highlighter-rouge>update</code> function I should have changed the return value from <code class=highlighter-rouge>(model, Cmd.none)</code> to <code class=highlighter-rouge>(model, Navigation.newUrl (toUrl newModel))</code></p><p>Same with the <code class=highlighter-rouge>init</code> function: I had to change the signature from <code class=highlighter-rouge>init : ( Model, Cmd Msg )</code> to <code class=highlighter-rouge>init : Result String Int -&gt; (Model, Cmd Msg)</code>. Nothing too dramatic, but I preferred avoiding it.</p><p>This is where I believe Elm route URL’s approach shines. The <code class=highlighter-rouge>init</code> and <code class=highlighter-rouge>update</code> function can remain exactly as they were, while we can add our routing needs via a completely <a href=https://github.com/Gizra/elm-spa-example/blob/1.0.0/src/elm/App/Router.elm>separate</a> set of functions. This makes the addition of routing consistent with my experience of building the app one step at a time, and knowing that what went into it is stable, solid, and most likely not to change if there are no new requirements.</p></div></div><div class="twelve wide column computer only"><div class="ui borderless secondary menu"><a class=item href="/content/og-message-stack-drupal8/"><i class="chevron left icon"></i> Organic Groups and Message Stack in Drupal 8</a><div class="right menu"><a class=item href="/content/elm-electron-build/">Elmctron - Build Desktop Apps with Elm and Electron <i class="chevron right icon"></i></a></div></div></div><div class="twelve wide column"><div class="ui segment basic"><div id=disqus_thread></div><script type=text/javascript>var disqus_shortname = 'gizra';
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();</script><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></div></div></div><footer class="ui black inverted vertical footer segment padded"><div class="ui center aligned container"><div class="ui three column stackable inverted grid"><div class=column><address><div class=strong>Israel Headquarters</div><div>5 Brenner Street, Tel Aviv</div><a class=telephone href=tel:+97233731222>+972-3-3731222</a> // <a class=email href=mailto:info@gizra.com>info@gizra.com</a></address></div><div class="column icons"><a target=_blank href=https://twitter.com/gizra_drupal><i class="twitter huge icon"></i></a> <a target=_blank href=https://github.com/Gizra/gizra.com><i class="github huge icon"></i></a></div><div class=column><address><div class=strong>North America Office</div><div>350 N. Orleans Street, Suite 9000N, Chicago, IL 60654</div><a class=telephone href=tel:+13125857625>312-585-7625</a> // <a class=email href=mailto:usoffice@gizra.com>usoffice@gizra.com</a></address></div></div></div></footer></div><script src=/bower_components/anchor-js/anchor.min.js></script><script src=/assets/javascript/script.js></script></body></html>