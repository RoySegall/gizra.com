<!DOCTYPE html><html><head><title>Elm-Hedley, App Overview</title><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta property=og:site_name content=Gizra><meta property=og:title content="Elm-Hedley, App Overview"><link rel=apple-touch-icon sizes=180x180 href=/assets/favicons/apple-touch-icon-180x180.png><link rel=icon type=image/png href=/assets/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/assets/favicons/favicon-194x194.png sizes=194x194><link rel=icon type=image/png href=/assets/favicons/favicon-96x96.png sizes=96x96><link rel=icon type=image/png href=/assets/favicons/android-chrome-192x192.png sizes=192x192><link rel=icon type=image/png href=/assets/favicons/favicon-16x16.png sizes=16x16><link rel=manifest href=/assets/favicons/manifest.json><meta name=msapplication-TileColor content=#000000><meta name=msapplication-TileImage content=/assets/favicons/mstile-144x144.png><meta name=theme-color content=#ffffff><link href="https://fonts.googleapis.com/css?family=Abril+Fatface&text=gizra" rel=stylesheet><link href="https://fonts.googleapis.com/css?family=Esteban" rel=stylesheet><link href="https://fonts.googleapis.com/css?family=Montserrat:500,700" rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.7/semantic.min.css integrity="sha256-wT6CFc7EKRuf7uyVfi+MQNHUzojuHN2pSw0YWFt2K5E=" crossorigin="anonymous"/><link rel=stylesheet href="/assets/stylesheets/style.css"/><script src=https://code.jquery.com/jquery-2.2.4.min.js integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.7/semantic.min.js integrity="sha256-flVaeawsBV96vCHiLmXn03IRJym7+ZfcLVvUWONCas8=" crossorigin=anonymous></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-6558346-3', 'auto');
  ga('send', 'pageview');</script></head><body class=pushable><div class="ui sidebar inverted vertical menu left"><a class="item active" href="/">Home</a> <a class=item href=/team>Team</a> <a class=item href=/blog>Blog</a> <a class=item href=/projects>Projects</a> <a class=item href=/our-story>Our Story</a> <a class=item href=/contact>Contact</a></div><div class=pusher><div class="ui grid container"><header class=row><div class="five wide column menu bar"><div class="ui large secondary menu"><a class="item sidebar-toggle"><i class="big sidebar icon"></i> Menu</a></div></div><div class="six wide computer eleven wide tablet column center aligned"><a class=gizra-logo href="/"><svg xmlns=http://www.w3.org/2000/svg width=252 height=104><title>gizra</title><path fill=#E27058 fill-rule=evenodd d="M44.3 21.6c.2 3.5 3 5.4 6 5.4 3.5 0 6.7-2 6.7-7s-3.6-7.7-8.5-7.7c-4.3 0-10.3 2.5-10.3 11 0 1.7.2 3.4.6 5.3-3.4-2-6.5-2.6-11.6-2.6-16 0-22.7 7.6-22.7 17.5 0 8.7 4 13.7 12.2 16-8.2 5-12 7.8-12 13.8C4.7 78 8 83 20.7 83h10c11 0 13.4 2 13.4 7 0 6.7-5.8 11.3-17 11.3s-13.4-4.7-13.4-9c0-1.8.2-3.5 1-5.8l-6.4-3C4.5 84.8.2 87 .2 92c0 6.8 7.5 11.3 25.8 11.3 21.2 0 29.6-8.5 29.6-20 0-14.4-12-17.2-23.8-17.2H21c-5.5 0-6.6-.4-6.6-1.4 0-1 1-2 4.6-4.4 2.2.4 5.4.8 8.5.8C40.3 61 49 55 49 43c0-6.8-4-10.5-8-13.3-.6-2.5-.8-4.6-.8-6.3 0-6.5 3-7 4.5-7 2.2 0 2.8 1.7 2.5 3.4l-3 1.8zM22 41.2C22 29.7 24 28 27 28s4.6 1.4 4.6 13.2v5c0 11-1.8 12.7-4.6 12.7-3.2 0-5-2.3-5-12V41zM62 10c0 4.4 2 9.8 10.6 9.8 7.6 0 10.6-4.3 10.6-10 0-6.3-3.8-9.6-10.4-9.6C65 .2 62 5 62 10zm-5.4 17v2h6.2v46H57v2h31.2v-2h-6V27H56.7zm82.5 0H95l-1.4 20.2H95c4.3-15 8-18.3 22.2-18.3h1L93 75.3V77h44l1.8-21.5h-1.5C133.5 69 127.5 75 115.6 75h-1.4l25-46v-2zm41 3c2.2 0 4.3 1 2.2 5.3h-3.8c-2.2 7.5 1 12 8.2 12 5.6 0 8.8-4 8.8-10 0-8-5-11.3-11.2-11.3-6.3 0-12 3.6-14 11V27H145v2h5.7v46h-5.8v2h32.6v-2h-7.4V47c0-9.5 4.7-17 9.7-17zm40.5 22.3c-15 0-24.2 2.4-24.2 13 0 10.5 8.2 12.8 15.6 12.8 7.2 0 10.3-2.7 12-7.7 1.2 5 6 7.8 14.4 7.8 9 0 13-3.5 13.5-16l-1.7-.2c-.5 8.8-2.3 10.8-4.2 10.8-1.7 0-3-1.2-3-5.5V46c0-15.2-5.5-19.8-22-19.8-14.3 0-22 4-22 13 0 5 2.6 8.6 9 8.6 5.3 0 9.3-3.3 9.3-8.2 0-2-.3-3.4-.8-4.7H214c-.6-1.2-.8-2.2-.8-3 0-3.4 3-4.3 5-4.3 4.2 0 5.3 3.5 5.3 16.8v8h-3zM219 73.8c-2 0-2.7-1-2.7-8.6v-1.6c0-6.4 2-9.6 6.5-9.6h.7v9.8c0 6.7-2.5 10-4.5 10z"/></svg></a><div class=tagline>We Build Websites</div></div><div class="five wide computer only column"></div></header><div class="ui grid centered post"><div class="sixteen wide mobile sixteen wide tablet twelve wide computer column"><div class="ui raised padded segment"><h1 class="ui dividing header"><div class="ui image"><img src=/assets/images/team/avatars/amitaibu.jpg class="ui circular image"></div><div class=content><a href="/content/elm-hedley-overview/">Elm-Hedley, App Overview</a><div class="sub header">By Amitai Burstein (@amitaibu) // 30 Dec 2015</div></div><div class="right floated column"><a href=/blog class="ui teal right ribbon big label">Blog Post</a></div></h1><p>In August 2015 I challenged myself (and later the rest of the Gizra devs) to create a typical web-app with all the bells and whistles in Elm. It’s called <a href=https://gizra.github.io/elm-hedley>elm-hedley</a>, and I’m super proud it is now featuring in Elm’s <a href="http://elm-lang.org/">front page</a>.</p><div class="ui segments"><div class="ui attached center aligned segment"><div class="ui image"><img src="https://www.gizra.com/assets/images/posts/elm-hedley-overview/image1.jpg"/></div></div></div><p>This post is going to give a high level overview and point out some parts that are worth noting. However, before diving into the technical section, it is important to emphasize the virtues of <em>simply doing</em>.</p><p>If you would go back in the commits history you would see some nasty stuff that have been completely overhauled and polished. The only way of getting to that “improving” part is of course by starting! Only after that will one become smarter and recognize what needs improving, as well as be more experienced to know how to do it.</p><h2 id=muv-model-update-view-components>MUV (Model-Update-View) Components</h2><p>The <a href="https://github.com/evancz/elm-architecture-tutorial/">Elm architecture</a> is advocating for a Model-Update-View for each components.</p><p>Model holds the data; Update is in charge of changing the data based on actions; and View is responsible for showing the data or triggering an action on a certain event (e.g. <code class=highlighter-rouge>onClick</code>).</p><p>We love this approach so much we have even ended up splitting each component to those files. So everything is consistent and makes finding stuff easy. The MUV is just a suggestion, you can add or remove stuff. Each <a href=https://github.com/Gizra/elm-hedley/tree/v1.0.0/src/elm/Pages/Event>component</a> can also have a <code class=highlighter-rouge>Test</code>, <code class=highlighter-rouge>Router</code>, <code class=highlighter-rouge>Utils</code>, or completely omit the <code class=highlighter-rouge>Update</code> and <code class=highlighter-rouge>View</code> if they are <a href=https://github.com/Gizra/elm-hedley/tree/v1.0.0/src/elm/Event>not needed</a>.</p><div class="ui segments"><div class="ui attached center aligned segment"><div class="ui image"><img src="https://www.gizra.com/assets/images/posts/elm-hedley-overview/image2.jpg"/></div></div></div><h2 id=components-vs-pages>Components Vs Pages</h2><p>The way we structure the files is each component resides in its own folder. Pages which are just a container of other components are placed under the <code class=highlighter-rouge>Pages</code> directory. In order to keep it simple, if a page is just a wrapper over a single component we won’t create both a component and a page. <a href=https://github.com/Gizra/elm-hedley/tree/v1.0.0/src/elm/Pages/User>The page</a> will be in fact a component. If one day the same page will need to become something more complex like the Event page, we can always move things around easily. The benefit of doing so is that it keeps things simple - no extra wiring needed merely for keeping things consistent (and harder to read).</p><h2 id=effects>Effects</h2><p>In line with the “Keep it Simple” approach, we realized that it’s not required for every component to have an <code class=highlighter-rouge>effect</code>. So we can just <a href=https://github.com/Gizra/elm-hedley/blob/v1.0.0/src/elm/EventAuthorFilter/Update.elm#L12>remove it</a>. On the other hand if we need the component to return more info to the parent we can do that as-well. The <a href=https://gizra.github.io/elm-hedley/#!/articles>Articles page</a> is a good example: The <a href=https://github.com/Gizra/elm-hedley/blob/v1.0.0/src/elm/ArticleForm/Update.elm#L38>ArticleForm</a> component that is responsible for the form for creating articles doesn’t need to have the newly created article as part of its model - it just needs to create it, and it hands it over back to the parent component. The parent component will make sure to <a href=https://github.com/Gizra/elm-hedley/blob/v1.0.0/src/elm/Pages/Article/Update.elm#L36-L44>append</a> it to the <a href=https://github.com/Gizra/elm-hedley/blob/v1.0.0/src/elm/ArticleList/Update.elm#L38-L41>ArticleList</a>.</p><h2 id=router>Router</h2><p>When building an SPA (Single Page Application) in Elm, this <a href=https://github.com/rgrempel/elm-route-hash>router</a> package is fun to work with. If you are new to Elm’s syntax it might seem a bit daunting at first, but I can assure you it’s doing exactly what it <a href=(https://github.com/Gizra/elm-hedley/blob/v1.0.0/src/elm/App/Router.elm)>should</a> be doing - and not more. I’ve written in <a href="/content/thinking-choosing-elm/">more detail</a> about how we love the fact that the URL change is in fact just a side-effect.</p><h2 id=unit-test-and-ci-integration>Unit test and CI integration</h2><p>I confess. In all our ~3 years of Angular we hardly did any unit testing. The setup and mocking was often too annoying, so we opted to do functional testing, which is of course great, but not as great as having both functional and unit tests.</p><p>It was super important for us to see that Travis badge telling us, go ahead, your latest PR didn’t break things.</p><p>While writing the tests was fun, as Elm’s pure functions make unit testing pretty much hassle free (see <a href=https://github.com/Gizra/elm-hedley/blob/v1.0.0/src/elm/Config/Test.elm>example</a>), the integration with Travis-CI was more challenging. The tests were running fine on the browser, but in a node environment they started failing. Looking at existing examples we saw that we had to start mock the browser inside node for the tests to pass. Yeah, mocking - that thing we really tried to avoid.</p><p>Looking for a better solution we dusted off our <a href="http://casperjs.org/">CasperJS</a> skills and came with a simple solution. Run the test via terminal using CasperJS (which in turn runs over PhantomJS). It worked!</p><p>We were so happy with the solution we’ve added it to our home grown <a href=https://github.com/Gizra/generator-elmlang>Yo generator</a>, so now everybody that uses it gets a fully working <a href=https://github.com/Gizra/elm-hedley/blob/v1.0.0/.travis.yml>Travis integration</a>.</p><div class="ui segments"><div class="ui attached center aligned segment"><div class="ui image"><img src="https://www.gizra.com/assets/images/posts/elm-hedley-overview/image3.jpg"/></div></div></div><h2 id=ports--interop>Ports &amp; Interop</h2><p>Any non-trivial web app has to make use of existing libraries. Rewriting Leaflet for maps / CKeditor for WYSIWYG editor / <a href="http://www.dropzonejs.com/">Dropzone</a> for file uploads in Elm doesn’t make much sense - it would be just too much work. So basically we let each JS library do its job and pass the information back to Elm that manages the state of the app.</p><p>After getting used to Elm’s compiler saving us from doing mistakes, developing JS “in the wild” suddenly feels scary :)</p><p>Admittedly some parts in the <a href=https://github.com/Gizra/elm-hedley/blob/v1.0.0/src/js/elm-interop.js>interop file</a> (short of <a href=https://en.wikipedia.org/wiki/Interoperability>interoperability</a>) could be improved in terms of interacting with the DOM, but still for us the Elm’s benefits are well worth the small hacks we had to do. I believe that as Elm matures those interactions would be even easier.</p><p>Here are for example the integration parts of Leaflet’s map under the <a href=http://gizra.github.io/elm-hedley/#!/events>Events</a> page - the <a href=https://github.com/Gizra/elm-hedley/blob/v1.0.0/src/elm/Main.elm#L51-L75>Elm code</a>, and the <a href=https://github.com/Gizra/elm-hedley/blob/v1.0.0/src/js/elm-interop.js#L64-L194>JS interop</a> one.</p><h2 id=gulp>Gulp</h2><p>There are <a href=https://medium.com/@ericclemmons/javascript-fatigue-48d4011b6fc4#.4ucjghbz7>too many tools</a> out there, and we have chosen Gulp. We’ve built an opinionated Gulp file that takes care of compiling Elm, building SASS, deploying to gh-pages, etc.</p><p>The nicest part of it for development is having the error messages appearing both on the terminal, and on the screen upon live reload.</p><p>The good news in case you’d like to use it, is that it’s part of the above mentioned Yo generator.</p><h2 id=whats-next>What’s Next</h2><p>I have tagged a <code class=highlighter-rouge>v1.0.0</code>, but like any other software, it just marks a milestone - we are constantly improving and polishing parts of it. As always, if you spot anything you’d like to change or add your pull requests are most welcome!</p></div></div><div class="twelve wide column computer only"><div class="ui borderless secondary menu"><a class=item href="/content/planet-elm/"><i class="chevron left icon"></i> Planet Elm</a><div class="right menu"><a class=item href="/content/apps-entity-restrictions/">Drupal, Hippies and Backend Restrictions <i class="chevron right icon"></i></a></div></div></div><div class="twelve wide column"><div class="ui segment basic"><div id=disqus_thread></div><script type=text/javascript>var disqus_shortname = 'gizra';
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();</script><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></div></div></div><footer class="ui black inverted vertical footer segment padded"><div class="ui center aligned container"><div class="ui three column stackable inverted grid"><div class=column><address><div class=strong>Israel Headquarters</div><div>5 Brenner Street, Tel Aviv</div><a class=telephone href=tel:+97233731222>+972-3-3731222</a> // <a class=email href=mailto:info@gizra.com>info@gizra.com</a></address></div><div class="column icons"><a target=_blank href=https://twitter.com/gizra_drupal><i class="twitter huge icon"></i></a> <a target=_blank href=https://github.com/Gizra/gizra.com><i class="github huge icon"></i></a></div><div class=column><address><div class=strong>North America Office</div><div>350 N. Orleans Street, Suite 9000N, Chicago, IL 60647</div><a class=telephone href=tel:+13125857625>312-585-7625</a> // <a class=email href=mailto:usoffice@gizra.com>usoffice@gizra.com</a></address></div></div></div></footer></div><script src=/bower_components/anchor-js/anchor.min.js></script><script src=/assets/javascript/script.js></script></body></html>