<!DOCTYPE html><html lang=en><head><title>Organic Groups and Message Stack in Drupal 8</title><meta name=viewport content="width=device-width,initial-scale=1"><meta property=og:site_name content=Gizra><meta property=og:title content="Organic Groups and Message Stack in Drupal 8"><meta name=description content="Gizra is a web strategy, design, and
  development agency with an extensive track record in complex content
  management solutions in Drupal and Elm."><meta property=og:description content=""><meta name=twitter:card content="summary_large_image"/><meta name=twitter:site content="@gizra_drupal"/><meta property=og:image content=https://www.gizra.com/assets/images/posts/og-message-stack-drupal8/thumb.jpg><link rel=apple-touch-icon sizes=180x180 href=/assets/favicons/apple-touch-icon-180x180.png><link rel=icon type=image/png href=/assets/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/assets/favicons/favicon-194x194.png sizes=194x194><link rel=icon type=image/png href=/assets/favicons/favicon-96x96.png sizes=96x96><link rel=icon type=image/png href=/assets/favicons/android-chrome-192x192.png sizes=192x192><link rel=icon type=image/png href=/assets/favicons/favicon-16x16.png sizes=16x16><link rel=manifest href=/assets/favicons/manifest.json><meta name=msapplication-TileColor content=#000000><meta name=msapplication-TileImage content=/assets/favicons/mstile-144x144.png><meta name=theme-color content=#ffffff><link href="https://fonts.googleapis.com/css?family=Abril+Fatface&text=gizra" rel=stylesheet><link href="https://fonts.googleapis.com/css?family=Esteban" rel=stylesheet><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700" rel=stylesheet><link href="https://fonts.googleapis.com/css?family=Montserrat:500,700" rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.13/semantic.min.css integrity=sha384-370KB8zqOlHxys9dcOyC7aCeXVtGyiKkWkp+cn8Mfoi13/sPj7fvSuhKRRdFbcip crossorigin=anonymous><link rel=stylesheet href="/assets/stylesheets/style.css"/><script src=https://code.jquery.com/jquery-2.2.4.min.js integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.13/semantic.min.js integrity=sha384-xfhRYqbW4Asj6UIfXB+Fp7GsmhF9uCf4R+oIGrp7YaBMAmlQWihnvGrW2WbdQRIS crossorigin=anonymous></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-6558346-3', 'auto');
  ga('send', 'pageview');</script></head><body class=pushable><div class="ui sidebar inverted vertical menu left"><a class="item active" href="/">Home</a> <a class=item href=/team>Team</a> <a class=item href=/blog>Blog</a> <a class=item href=/podcast>Podcast</a> <a class=item href=/projects>Projects</a> <a class=item href=/our-story>Our Story</a> <a class=item href=/contact>Contact</a></div><div class=pusher><div class="ui grid container"><header class=row><div class="five wide column menu bar"><div class="ui large secondary menu"><a class="item sidebar-toggle"><i class="big sidebar icon"></i> Menu</a></div></div><div class="six wide computer six wide tablet eleven wide mobile column center aligned"><a class=gizra-logo href="/"><svg version=1.1 width=252 height=104 aria-labelledby="title desc" role=img><title id=title>Gizra Logo</title><desc id=desc>The Gizra Logo</desc><path fill=#E27058 fill-rule=evenodd d="M44.3 21.6c.2 3.5 3 5.4 6 5.4 3.5 0 6.7-2 6.7-7s-3.6-7.7-8.5-7.7c-4.3 0-10.3 2.5-10.3 11 0 1.7.2 3.4.6 5.3-3.4-2-6.5-2.6-11.6-2.6-16 0-22.7 7.6-22.7 17.5 0 8.7 4 13.7 12.2 16-8.2 5-12 7.8-12 13.8C4.7 78 8 83 20.7 83h10c11 0 13.4 2 13.4 7 0 6.7-5.8 11.3-17 11.3s-13.4-4.7-13.4-9c0-1.8.2-3.5 1-5.8l-6.4-3C4.5 84.8.2 87 .2 92c0 6.8 7.5 11.3 25.8 11.3 21.2 0 29.6-8.5 29.6-20 0-14.4-12-17.2-23.8-17.2H21c-5.5 0-6.6-.4-6.6-1.4 0-1 1-2 4.6-4.4 2.2.4 5.4.8 8.5.8C40.3 61 49 55 49 43c0-6.8-4-10.5-8-13.3-.6-2.5-.8-4.6-.8-6.3 0-6.5 3-7 4.5-7 2.2 0 2.8 1.7 2.5 3.4l-3 1.8zM22 41.2C22 29.7 24 28 27 28s4.6 1.4 4.6 13.2v5c0 11-1.8 12.7-4.6 12.7-3.2 0-5-2.3-5-12V41zM62 10c0 4.4 2 9.8 10.6 9.8 7.6 0 10.6-4.3 10.6-10 0-6.3-3.8-9.6-10.4-9.6C65 .2 62 5 62 10zm-5.4 17v2h6.2v46H57v2h31.2v-2h-6V27H56.7zm82.5 0H95l-1.4 20.2H95c4.3-15 8-18.3 22.2-18.3h1L93 75.3V77h44l1.8-21.5h-1.5C133.5 69 127.5 75 115.6 75h-1.4l25-46v-2zm41 3c2.2 0 4.3 1 2.2 5.3h-3.8c-2.2 7.5 1 12 8.2 12 5.6 0 8.8-4 8.8-10 0-8-5-11.3-11.2-11.3-6.3 0-12 3.6-14 11V27H145v2h5.7v46h-5.8v2h32.6v-2h-7.4V47c0-9.5 4.7-17 9.7-17zm40.5 22.3c-15 0-24.2 2.4-24.2 13 0 10.5 8.2 12.8 15.6 12.8 7.2 0 10.3-2.7 12-7.7 1.2 5 6 7.8 14.4 7.8 9 0 13-3.5 13.5-16l-1.7-.2c-.5 8.8-2.3 10.8-4.2 10.8-1.7 0-3-1.2-3-5.5V46c0-15.2-5.5-19.8-22-19.8-14.3 0-22 4-22 13 0 5 2.6 8.6 9 8.6 5.3 0 9.3-3.3 9.3-8.2 0-2-.3-3.4-.8-4.7H214c-.6-1.2-.8-2.2-.8-3 0-3.4 3-4.3 5-4.3 4.2 0 5.3 3.5 5.3 16.8v8h-3zM219 73.8c-2 0-2.7-1-2.7-8.6v-1.6c0-6.4 2-9.6 6.5-9.6h.7v9.8c0 6.7-2.5 10-4.5 10z"/></svg></a><div class=tagline>We Build Websites</div></div><div class="five wide computer only column"></div></header><div class="ui grid centered post"><div class="sixteen wide mobile sixteen wide tablet twelve wide computer column"><div class="ui raised padded segment"><h1 class="ui dividing header"><div class="ui image"><img src=/assets/images/team/avatars/amitaibu.jpg class="ui circular image"></div><div class=content><a href="/content/og-message-stack-drupal8/">Organic Groups and Message Stack in Drupal 8</a><div class="sub header">By Amitai Burstein (@amitaibu) // 09 Jun 2016</div></div><div class="right floated column"><a href=/blog class="ui teal right ribbon big label">Blog Post</a></div></h1><p>Hi geeks! Did the post title get you excited? Great, because Organic Groups (OG) and Message stack are getting closer to being Drupal 8 ready.</p><p>I’d like to give an overview about their state, the amazing community effort around them, and also share some of my personal thoughts about contribution to Drupal 8 in general.</p><h2 id=organic-groups>Organic Groups</h2><p><strong>The heroes:</strong> <a href=https://www.drupal.org/u/RoySegall>@RoySegall</a>, <a href=https://www.drupal.org/u/pfrenssen>@pfrenssen</a> <a href=https://www.drupal.org/u/damiankloip>@damiankloip</a>, <a href=https://www.drupal.org/u/chx>@chx</a> et al.</p><p>For years Organic Groups has been one of the proven solutions for multi-sites functionality, in the form of one code base, one database, and one dashboard to rule them all. After so many years and seeing so many different implementations, such as Harvard’s OpenScholar, OpenAtrium, and many others, I’m even more confident OG is doing many things right.</p><p>Most of OG7’s concepts are being migrated to OG8, but obviously this is also a good time to fix some old mistakes. One of the mistakes was treating users and content (i.e. non-user entities) alike. But, well, you know - they are not. Because when we came to re-think of it, membership really makes sense only for users. For example, if the membership state is <code class=highlighter-rouge>active</code>, <code class=highlighter-rouge>pending</code> or <code class=highlighter-rouge>blocked</code>, that should indeed be applied only to users. So we’ve changed it:</p><ul><li>A reference between a group content and a group is done via an entity reference field with a default storage. The link between them is simply registered as a row in the DB.</li><li>A reference between a user and a group is also done via an entity reference field, however the field storage is custom. It’s the <code class=highlighter-rouge>OgMembership</code> entity you know from OG7.</li></ul><p>Both those references are done through core’s entity reference. This opens up a lot of possibilities for fine-grained control, thank’s to the selection handler concept.</p><p>Having this conceptual shift trickles down to the code, and cleans it up quite a bit. To be sure we are not breaking anything, we’re adding tests. Lots of tests, with a nice mix of unit and kernel tests. Heck, we even check extreme cases like arbitrary, yet work-life balanced <a href=https://github.com/amitaibu/og/blob/c2bf4de582105e8c71f52d48c423c98d18fe75bf/tests/src/Unit/PermissionEventTest.php#L389-L390>permissions</a> :)</p><p>If you want to jump in and help, development is happening on a temporary <a href=https://github.com/amitaibu/og>GitHub repo</a>.</p><h3 id=group-module>Group module</h3><p>At DrupalCon, a few people asked for my opinion on the <a href=https://www.drupal.org/project/group>Group</a> module. I’m happy to say that none of them were surprised that I was very positive about it - which is probably another great case for open source.</p><p>So to repeat the answer I gave back in New Orleans, if Group is working for you, and satisfies your needs, go ahead and use it. For completeness here’s my critique on some of it’s core concepts:</p><p>One of the core concepts of Group is that a group isn’t a node. It’s a <code class=highlighter-rouge>Group</code> entity. That’s fine, also OG can have any entity as a group, but I’d argue that 90% of the time your group should be content. Because more often than not, groups need to have published/unpublished status. Or because groups need to have privacy options, and even in Drupal 8 we have only <code class=highlighter-rouge>{node_access}</code> table, not an <code class=highlighter-rouge>{entity_access}</code>.</p><p>Furthermore, there are quite a few cases where a single group content should be attached to multiple groups. This is where the power of OG kicks in, doing all the heavy lifting of making sure permissions are being handled correctly. I can assure you this is not a trivial task.</p><p>OG alternatives have always been there, and choosing the right tool for the problem is important. Group is actually solving a subset of the challenges OG deals with. If it works for you, go ahead and use it. I know you’ll be in good hands with it because Group’s author <a href=https://www.drupal.org/u/kristiaanvandeneynde>@kristiaanvandeneynde</a> is a great person and a wonderful developer.</p><h2 id=message-stack>Message stack</h2><p><strong>The heroes:</strong> <a href=https://www.drupal.org/u/RoySegall>@RoySegall</a>, <a href=https://www.drupal.org/u/jhedstrom>@jhedstrom</a>, <a href=https://www.drupal.org/u/mccrodp>@mccrodp</a> et al.</p><p>The message stack is mostly ported to D8, and it has already reached a good place. I’m still not cutting an alpha release, because it requires polishing and might have a few data structure changes.</p><p>There are no big differences here in terms of concepts, although worth mentioning <a href=https://www.drupal.org/u/bojanz>@bojanz’s</a> suggestion to rename <code class=highlighter-rouge>message type</code> to <code class=highlighter-rouge>message template</code>. Suddenly it makes it much clearer what the intention of <code class=highlighter-rouge>message template</code> is.</p><p>If you would like to contribute you are most welcome to the repos: <a href=https://github.com/Gizra/message>Message</a>, <a href=https://github.com/Gizra/message_notify>Message notify</a> and <a href=https://github.com/Gizra/message_subscribe>Message subscribe</a></p><h2 id=on-contribution-and-drupal-8>On Contribution and Drupal 8</h2><p>New major releases can be hard, as you are expected to port all of your modules. At once. It’s a process that takes a lot of time, and skills, and I’m grateful for having such great community members helping with it.</p><p>I’d like to reach out to some community members I was talking with in DrupalCon which told me they felt bad they were not porting their modules fast enough: Don’t feel bad about it! “Feeling bad” is one of the main causes for burn outs. Take your time. Do it out of passion, and reach out to the community to help you. It’s your module, but if it’s used by others, they can and should help you.</p><p>In my case, for example, OG7 was written (and re-written) in the days I had one kid and Gizra had about seven employees and a single office. Now, I have three kids, Gizra has over twenty employees sitting in both the Israel and US office. And do you know how I feel about my (Drupal) contribution rate? (Most days) I feel marvelous about it. Because I do it on my own terms or work time, I’m not burned out, and I still love what I do.</p></div></div><div class="twelve wide column computer only"><div class="ui borderless secondary menu"><a class=item href="/content/drupal-8-attachment-migration/"><i class="chevron left icon"></i> Drupal 8: Migrate Nodes with Attachments Easily</a><div class="right menu"><a class=item href="/content/faithful-elm-amazing-router/">Faithful Elm and the Amazing Router <i class="chevron right icon"></i></a></div></div></div><div class="twelve wide column"><div class="ui segment basic"><div id=disqus_thread></div><script type=text/javascript>var disqus_shortname = 'gizra';
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();</script><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></div></div></div><footer class="ui black inverted vertical footer segment padded"><div class="ui center aligned container"><div class="ui three column stackable inverted grid"><div class=column><address><div class=strong>Israel Headquarters</div><div>5 Brenner Street, Tel Aviv</div><a class=telephone href=tel:+97233731222>+972-3-3731222</a> // <a class=email href=mailto:info@gizra.com>info@gizra.com</a></address></div><div class="column icons"><a target=_blank href=https://twitter.com/gizra_drupal><i class="twitter huge icon"></i></a> <a target=_blank href=https://github.com/Gizra/gizra.com><i class="github huge icon"></i></a></div><div class=column><address><div class=strong>North America Office</div><div>350 N. Orleans Street, Suite 9000N, Chicago, IL 60654</div><a class=telephone href=tel:+13125857625>312-585-7625</a> // <a class=email href=mailto:usoffice@gizra.com>usoffice@gizra.com</a></address></div></div></div></footer></div><script src=/bower_components/anchor-js/anchor.min.js></script><script src=/assets/javascript/script.js></script></body></html>